<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue | Hello VuePress</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/myvuepress/1.png">
    <meta name="description" content="">
    <link rel="preload" href="/myvuepress/assets/css/0.styles.55445a51.css" as="style"><link rel="preload" href="/myvuepress/assets/js/app.7911cd3e.js" as="script"><link rel="preload" href="/myvuepress/assets/js/2.a950c495.js" as="script"><link rel="preload" href="/myvuepress/assets/js/11.351c49a2.js" as="script"><link rel="prefetch" href="/myvuepress/assets/js/10.4d65385b.js"><link rel="prefetch" href="/myvuepress/assets/js/12.2a015a0c.js"><link rel="prefetch" href="/myvuepress/assets/js/3.93155463.js"><link rel="prefetch" href="/myvuepress/assets/js/4.f1dc73ce.js"><link rel="prefetch" href="/myvuepress/assets/js/5.7587379c.js"><link rel="prefetch" href="/myvuepress/assets/js/6.fc275a41.js"><link rel="prefetch" href="/myvuepress/assets/js/7.3c7d7900.js"><link rel="prefetch" href="/myvuepress/assets/js/8.8e347517.js"><link rel="prefetch" href="/myvuepress/assets/js/9.d0bf9229.js">
    <link rel="stylesheet" href="/myvuepress/assets/css/0.styles.55445a51.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myvuepress/" class="home-link router-link-active"><!----> <span class="site-name">Hello VuePress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="web" class="dropdown-title"><span class="title">web</span> <span class="arrow down"></span></button> <button type="button" aria-label="web" class="mobile-dropdown-title"><span class="title">web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myvuepress/" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/css/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/javascript/javascript.html" class="nav-link">
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/web/web.html" class="nav-link">
  web 系统
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/browser/browser.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/http/http.html" class="nav-link">
  网络通信
</a></li></ul></div></div><div class="nav-item"><a href="/myvuepress/vue/vue.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="github" class="dropdown-title"><span class="title">github</span> <span class="arrow down"></span></button> <button type="button" aria-label="github" class="mobile-dropdown-title"><span class="title">github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/txs1992/focus-outside" target="_blank" rel="noopener noreferrer" class="nav-link external">
  focus-outside
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/txs1992/stylus-converter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  stylus-converter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="web" class="dropdown-title"><span class="title">web</span> <span class="arrow down"></span></button> <button type="button" aria-label="web" class="mobile-dropdown-title"><span class="title">web</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myvuepress/" class="nav-link">
  html
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/css/css.html" class="nav-link">
  css
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/javascript/javascript.html" class="nav-link">
  javascript
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/web/web.html" class="nav-link">
  web 系统
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/browser/browser.html" class="nav-link">
  浏览器
</a></li><li class="dropdown-item"><!----> <a href="/myvuepress/http/http.html" class="nav-link">
  网络通信
</a></li></ul></div></div><div class="nav-item"><a href="/myvuepress/vue/vue.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  vue
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="github" class="dropdown-title"><span class="title">github</span> <span class="arrow down"></span></button> <button type="button" aria-label="github" class="mobile-dropdown-title"><span class="title">github</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/txs1992/focus-outside" target="_blank" rel="noopener noreferrer" class="nav-link external">
  focus-outside
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li class="dropdown-item"><!----> <a href="https://github.com/txs1992/stylus-converter" target="_blank" rel="noopener noreferrer" class="nav-link external">
  stylus-converter
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/myvuepress/vue/vue.html" aria-current="page" class="active sidebar-link">Vue</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#单页面应用" class="sidebar-link">单页面应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#什么是单页面应用" class="sidebar-link">什么是单页面应用</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#单页面应用的优缺点" class="sidebar-link">单页面应用的优缺点</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#双向绑定" class="sidebar-link">双向绑定</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#生命周期" class="sidebar-link">生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#生命周期的三个阶段" class="sidebar-link">生命周期的三个阶段</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#每个阶段的核心" class="sidebar-link">每个阶段的核心</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#计算属性与侦听器" class="sidebar-link">计算属性与侦听器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#computed" class="sidebar-link">computed</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#watch" class="sidebar-link">watch</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#计算属性、methods、watch-区别" class="sidebar-link">计算属性、Methods、watch 区别</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#class-与-style-的绑定" class="sidebar-link">Class 与 Style 的绑定</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#虚拟-dom" class="sidebar-link">虚拟 dom</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#了解浏览器渲染步骤" class="sidebar-link">了解浏览器渲染步骤</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#虚拟-dom-的好处" class="sidebar-link">虚拟 DOM 的好处</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#响应式数据-双向数据绑定" class="sidebar-link">响应式数据(双向数据绑定)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#核心" class="sidebar-link">核心</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#实现过程" class="sidebar-link">实现过程</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#vue-性能优化" class="sidebar-link">Vue 性能优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#代码层面优化" class="sidebar-link">代码层面优化</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#webpack-层面优化" class="sidebar-link">Webpack 层面优化</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#基础-web-技术优化" class="sidebar-link">基础 web 技术优化</a></li></ul></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#vuex" class="sidebar-link">Vuex</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#五个核心参数" class="sidebar-link">五个核心参数</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#辅助函数" class="sidebar-link">辅助函数</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#模块化写法" class="sidebar-link">模块化写法</a></li><li class="sidebar-sub-header"><a href="/myvuepress/vue/vue.html#与-localstorage-、cookie-的区别" class="sidebar-link">与 localStorage 、cookie 的区别</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue"><a href="#vue" class="header-anchor">#</a> Vue</h1> <h2 id="单页面应用"><a href="#单页面应用" class="header-anchor">#</a> 单页面应用</h2> <h3 id="什么是单页面应用"><a href="#什么是单页面应用" class="header-anchor">#</a> 什么是单页面应用</h3> <div class="custom-block tip"><p class="custom-block-title">SPA（ single-page application ）</p> <p>仅在 Web 页面初始化时加载相应的 HTML、JavaScript 和 CSS</p></div> <p>一旦页面加载完成，SPA 不会因为用户的操作而进行页面的重新加载或跳转<br>
取而代之的是利用路由机制实现 HTML 内容的变换，UI 与用户的交互，避免页面的重新加载</p> <h3 id="单页面应用的优缺点"><a href="#单页面应用的优缺点" class="header-anchor">#</a> 单页面应用的优缺点</h3> <h4 id="优点"><a href="#优点" class="header-anchor">#</a> 优点：</h4> <ul><li>用户体验好、快，内容的改变不需要重新加载整个页面，避免了不必要的跳转和重复渲染</li> <li>基于上面一点，SPA 相对对服务器压力小</li> <li>前后端职责分离，架构清晰，前端进行交互逻辑，后端负责数据处理</li></ul> <h4 id="缺点"><a href="#缺点" class="header-anchor">#</a> 缺点：</h4> <ul><li><p>初次加载耗时多<br>
为实现单页 Web 应用功能及显示效果，需要在加载页面的时候将 JavaScript、CSS 统一加载，部分页面按需加载</p></li> <li><p>前进后退路由管理<br>
由于单页应用在一个页面中显示所有的内容，所以不能使用浏览器的前进后退功能，所有的页面切换需要自己建立堆栈管理</p></li> <li><p>SEO 难度较大<br>
由于所有的内容都在一个页面中动态替换显示，所以在 SEO 上其有着天然的弱势</p></li></ul> <blockquote><p>牢记单页面应用的优缺点</p></blockquote> <h2 id="双向绑定"><a href="#双向绑定" class="header-anchor">#</a> 双向绑定</h2> <h2 id="生命周期"><a href="#生命周期" class="header-anchor">#</a> 生命周期</h2> <div class="custom-block tip"><p class="custom-block-title">生命周期钩子</p> <p>生命周期钩子 = 生命周期函数 = 生命周期事件</p></div> <h3 id="生命周期的三个阶段"><a href="#生命周期的三个阶段" class="header-anchor">#</a> 生命周期的三个阶段</h3> <ul><li>创建期间</li> <li>运行期间</li> <li>销毁期间</li></ul> <h3 id="每个阶段的核心"><a href="#每个阶段的核心" class="header-anchor">#</a> 每个阶段的核心</h3> <h4 id="beforecreate"><a href="#beforecreate" class="header-anchor">#</a> beforeCreate</h4> <p>这是我们遇到的第一个生命周期函数<br>
表示实例完全被创建出来，会执行它<br>
data 和 methods 中的数据都没有被初始化，无法调用</p> <h4 id="created"><a href="#created" class="header-anchor">#</a> created</h4> <p>data 和 methods 都已经被初始化好了<br>
这是最早调用 data 和 methods 的地方</p> <div class="custom-block warning"><p class="custom-block-title">created</p> <p>此阶段开始，表示 Vue 开始编译模板</p></div> <p>Vue 代码中的那些指令需要被执行，最终，在内存中生成一个编译好的模板字符串，然后把这个模板字符串渲染为内存中的 DOM</p> <p>然而此时还只是在内存中，渲染好的模板并没有挂载到真正的页面中去</p> <h4 id="beforemount"><a href="#beforemount" class="header-anchor">#</a> beforeMount</h4> <div class="custom-block tip"><p class="custom-block-title">模板已在内存中编译完成</p> <p>但是还没有渲染到页面上</p></div> <p>页面中的元素，还没有被真正替换过来，只是单纯的模板字符串，页面还是旧的</p> <div class="language-js extra-class"><pre class="language-js"><code>比如 <span class="token punctuation">{</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">}</span> 这样调用的 data，显示出来就是 <span class="token punctuation">{</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><h4 id="mounted"><a href="#mounted" class="header-anchor">#</a> mounted</h4> <div class="custom-block tip"><p class="custom-block-title">内存中的模板已经真实的挂载到页面当中</p> <p>展示给用户的就是渲染好的页面</p></div> <div class="custom-block warning"><p class="custom-block-title">注意：</p> <p>mounted 是实例创建的最后一个生命周期函数，<br>
当执行完 mounted 就表示，实例已经被完全创建好了</p></div> <p>由此开始，组件进入运行阶段，脱离了创建阶段<br>
此时如果没有其他操作的话，这个实例，就静静的，一直躺在我们的内存中</p> <blockquote><p>如果想要操作页面上的DOM节点，最早在 mounted 中进行</p></blockquote> <h4 id="beforeupdate"><a href="#beforeupdate" class="header-anchor">#</a> beforeUpdate</h4> <div class="custom-block tip"><p class="custom-block-title">data 中的数据改变了</p> <p>但是我们的页面还没有被更新</p></div> <p><strong>beforeUpdate 执行后</strong></p> <p>根据 data 中最新的数据，在内存中渲染一份 最新的内存DOM树。</p> <p>当最新的 内存DOM树被更新之后，会把最新的内存DOM树重新渲染到真实页面当中去。</p> <p>这时候就完成了数据从 data（Model层）-&gt; view（视图层）的更新</p> <h4 id="updated"><a href="#updated" class="header-anchor">#</a> updated</h4> <p>该函数周期内，页面和 data 的数据已经保持了同步</p> <div class="custom-block warning"><p class="custom-block-title">要注意</p> <p>运行阶段，beforeUpdate 和 updated<br>
这两个时间会根据 data 数据的改变，
选择性的触发 0 次 至多次</p></div> <h4 id="beforedestroy"><a href="#beforedestroy" class="header-anchor">#</a> beforeDestroy</h4> <div class="custom-block tip"><p class="custom-block-title">此阶段标志着</p> <p>Vue 实例从运行阶段进入到销毁阶段</p></div> <p>此阶段，实例身上所有的 data 和 所有 methods，以及过滤器、指令...都处于可用状态，还没有真正执行销毁</p> <h4 id="destroyed"><a href="#destroyed" class="header-anchor">#</a> destroyed</h4> <p>该阶段，组件已经被完全销毁了，所有的数据、方法、指令、过滤器...都不可用了</p> <h2 id="计算属性与侦听器"><a href="#计算属性与侦听器" class="header-anchor">#</a> 计算属性与侦听器</h2> <div class="custom-block tip"><p class="custom-block-title">计算属性的本质，就是一个方法</p> <p>只不过我们在使用的时候，是把他们的名称直接当做属性来使用了,</p></div> <h3 id="computed"><a href="#computed" class="header-anchor">#</a> computed</h3> <p>在computed中，可以定义一些属性<br>
这些属性，就叫做【计算属性】</p> <p>我们把他们的名称直接当做属性来使用，
但我们并不会把这些属性当做方法来调用</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function-variable function">‘fullname’</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'ok'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>firstname <span class="token operator">+</span> <span class="token string">'-'</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>middlename<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">这里要注意几点</p> <ul><li><p>计算属性在引用的时候，一定不要加 () 去调用，直接当做普通属性去用就好了</p></li> <li><p>计算属性这个function的内部，所用到的任何data中数据发生了变化，就会重新计算属性的值</p></li> <li><p>计算属性的求值结果，会被缓存起来，方便下次直接使用。只要计算属性中用到的data数据没有发生过变化，计算属性就不会重新求值触发function</p></li></ul></div> <h3 id="watch"><a href="#watch" class="header-anchor">#</a> watch</h3> <p>Watch 是一个对象，键是需要观察的表达式，值是对应的函数，<br>
主要用来监听特定数据的变化，从而进行某些具体业务逻辑的操作</p> <p><em>可以将watch看做是computed和methods的结合体</em></p> <h3 id="计算属性、methods、watch-区别"><a href="#计算属性、methods、watch-区别" class="header-anchor">#</a> 计算属性、Methods、watch 区别</h3> <div class="custom-block warning"><p class="custom-block-title">计算属性、Methods、watch 区别</p> <ul><li>计算属性无论如何都要return出去一个值，但watch不用</li> <li>Methods 主要用来处理大量的业务逻辑，而计算属性处理数据，依赖缓存</li> <li>Watch 是一个对象，键是需要观察的表达式，值是对应的函数，用来监听特定的数据</li></ul></div> <h2 id="class-与-style-的绑定"><a href="#class-与-style-的绑定" class="header-anchor">#</a> Class 与 Style 的绑定</h2> <h2 id="虚拟-dom"><a href="#虚拟-dom" class="header-anchor">#</a> 虚拟 dom</h2> <h3 id="了解浏览器渲染步骤"><a href="#了解浏览器渲染步骤" class="header-anchor">#</a> 了解浏览器渲染步骤</h3> <h3 id="虚拟-dom-的好处"><a href="#虚拟-dom-的好处" class="header-anchor">#</a> 虚拟 DOM 的好处</h3> <h2 id="响应式数据-双向数据绑定"><a href="#响应式数据-双向数据绑定" class="header-anchor">#</a> 响应式数据(双向数据绑定)</h2> <h3 id="核心"><a href="#核心" class="header-anchor">#</a> 核心</h3> <div class="custom-block tip"><p class="custom-block-title">监听数据变化</p> <p>做一个拦截的效果，并通知视图或者数据进行更新</p></div> <ul><li>ES5：Object.defineProperty</li> <li>ES6：Proxy  （Vue 3.0 使用了新的拦截器）</li></ul> <h3 id="实现过程"><a href="#实现过程" class="header-anchor">#</a> 实现过程</h3> <div class="custom-block tip"><p class="custom-block-title">Vue 在初始化数据时</p> <p>会给 data 中的属性使用 object.defineProperty 重新定义所有数据</p></div> <h4 id="es5-object-defineproperty-实现数据拦截"><a href="#es5-object-defineproperty-实现数据拦截" class="header-anchor">#</a> ES5：Object.defineProperty 实现数据拦截</h4> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  姓名：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>spanName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>inpName<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">''</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
  
<span class="token keyword">let</span> newObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 深克隆 obj</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token string">'name'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  <span class="token comment">// 监听数据 obj 中 name 的改变</span>
  <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 获得数据时</span>
    <span class="token keyword">return</span> newObj<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// 防止操作 Obj.name 死循环</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">// 设置数据时</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>val<span class="token operator">===</span>newObj<span class="token punctuation">.</span>name<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    newObj<span class="token punctuation">.</span>name <span class="token operator">=</span> val<span class="token punctuation">;</span>
    <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token comment">// 观察，赋值</span>
  spanName<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  inpName<span class="token punctuation">.</span>value <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

上面是数据修改视图，
那么如何做到视图修改数据呢？

inpName<span class="token punctuation">.</span><span class="token function-variable function">oninput</span><span class="token operator">=</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  obj<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><blockquote><p>总结思路：<br>
1、对原始数据进行克隆<br>
2、给对象中的每个属性设置监听或者深度监听，每当数据变化时，修改对应视图或者数据</p></blockquote> <p><em>Vue 要做的就是给每个 data 数据进行循环绑定的过程</em></p> <h4 id="es6-proxy-vue-3-0-使用了新的拦截器"><a href="#es6-proxy-vue-3-0-使用了新的拦截器" class="header-anchor">#</a> ES6：Proxy（Vue 3.0 使用了新的拦截器）</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span><span class="token punctuation">{</span> <span class="token comment">// 直接监听整个对象</span>
  <span class="token function">get</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>prop<span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 监听对象中的哪个属性</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> target<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">set</span><span class="token punctuation">(</span>target<span class="token punctuation">,</span>prop<span class="token punctuation">,</span>value<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    target<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> value
    <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">function</span> <span class="token function">observer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 观察，赋值</span>
   spanName<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
   inpName<span class="token punctuation">.</span>value <span class="token operator">=</span> obj<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>默认 Vue 在初始化数据时，会给 data 中的属性使用 object.defineProperty 重新定义所有数据</p> <p>当页面取到对应属性，会进行依赖收集（收集当前组件中的watcher），如果属性发生变化就会通知相关依赖进行更新操作</p> <p>object.defineProperty</p> <ul><li>get 方法，收集 watcher</li> <li>set 方法，通知 notify()</li></ul> <h2 id="vue-性能优化"><a href="#vue-性能优化" class="header-anchor">#</a> Vue 性能优化</h2> <h3 id="代码层面优化"><a href="#代码层面优化" class="header-anchor">#</a> 代码层面优化</h3> <h4 id="尽量减少-data-数据"><a href="#尽量减少-data-数据" class="header-anchor">#</a> 尽量减少 data 数据</h4> <p>data 中的每个数据都会增加 getter 和 setter，会收集对应的 watcher</p> <h4 id="v-if-和-v-show-区分使用场景"><a href="#v-if-和-v-show-区分使用场景" class="header-anchor">#</a> v-if 和 v-show 区分使用场景</h4> <p>v-if 是 真正 的条件渲染，因为它会确保在切换过程中条件块内的事件监听器和子组件适当地被销毁和重建</p> <p>如果在初始渲染时为假，则什么也不做直到条件为真时才会开始渲染</p> <h4 id="computed-和-watch-区分使用场景"><a href="#computed-和-watch-区分使用场景" class="header-anchor">#</a> computed 和 watch 区分使用场景</h4> <ul><li><p>computed 是计算属性，依赖 data 中的属性值，并且 computed 的值有缓存，只有它依赖的属性值发生改变，它才会去获取，否则会直接从缓存中拿数据；<br>
不支持异步操作</p></li> <li><p>watch 更多的是「观察」的作用，类似于某些数据的监听回调，每当监听的数据变化时都会执行回调进行后续操作，可以操作一系列数据，堪称一对多；<br>
并且支持异步操作</p></li></ul> <h4 id="v-for-遍历必须为-item-添加-key-且避免同时使用-v-if"><a href="#v-for-遍历必须为-item-添加-key-且避免同时使用-v-if" class="header-anchor">#</a> v-for 遍历必须为 item 添加 key，且避免同时使用 v-if</h4> <ul><li><p><strong>为什么必须添加 key？</strong><br>
这是为了方便 Vue.js 内部机制精准找到该条列表数据
当 state 更新时，新的状态值和旧的状态值对比，较快地定位到 diff</p></li> <li><p><strong>为什么避免使用 v-if</strong><br>
v-for 比 v-if 优先级高，每次都要先遍历整个数组，会影响性能 所以必要情况下应改为 computed 属性</p></li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user in users<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.isActive<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    {{ user.name }}  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>这种方法是非常不推荐的</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user in activeUsers<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user.id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    {{ user.name }}  
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
computed<span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token function-variable function">activeUsers</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>users<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">user</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> user<span class="token punctuation">.</span>isActive
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>可以先过滤一遍原数据，再进行循环<br>
我们要使用这种方式</p> <h4 id="spa-页面采用-keep-alive-缓存组件"><a href="#spa-页面采用-keep-alive-缓存组件" class="header-anchor">#</a> SPA 页面采用 keep-alive 缓存组件</h4> <h4 id="key-保证唯一"><a href="#key-保证唯一" class="header-anchor">#</a> key 保证唯一</h4> <h4 id="长列表的性能优化"><a href="#长列表的性能优化" class="header-anchor">#</a> 长列表的性能优化</h4> <h4 id="事件的销毁"><a href="#事件的销毁" class="header-anchor">#</a> 事件的销毁</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>防止内存泄露</p></div> <p>Vue 组件销毁时，会自动清理它与其它实例的连接，解绑它的全部指令及事件监听器，但是仅限于组件本身的事件</p> <p>如果在 js 内使用 addEventListene 等方式是不会自动销毁的，我们需要在组件销毁时手动移除这些事件的监听，以免造成内存泄露</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">created</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>click<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">beforeDestroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>click<span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="防抖、节流"><a href="#防抖、节流" class="header-anchor">#</a> 防抖、节流</h4> <h4 id="图片懒加载"><a href="#图片懒加载" class="header-anchor">#</a> 图片懒加载</h4> <h4 id="路由懒加载"><a href="#路由懒加载" class="header-anchor">#</a> 路由懒加载</h4> <div class="custom-block tip"><p class="custom-block-title">进入首页时并不需要加载所有路由</p> <p>加载过多首页会白屏<br>
应当在该路由被访问时才加载对应组件</p></div> <p>Vue 是单页面应用，可能会有很多的路由引入，这样使用 webpcak 打包后的文件很大。<br>
当进入首页时，加载的资源过多，页面会出现白屏的情况，不利于用户体验</p> <p>如果我们能把不同路由对应的组件分割成不同的代码块，然后当路由被访问的时候才加载对应的组件，这样就更加高效了</p> <p>这样会大大提高首屏显示的速度，但是可能其他的页面的速度就会降下来</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">Foo</span> <span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  routes<span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>path<span class="token operator">:</span><span class="token string">'/foo'</span><span class="token punctuation">,</span>component<span class="token operator">:</span>Foo<span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="第三方插件的按需引入"><a href="#第三方插件的按需引入" class="header-anchor">#</a> 第三方插件的按需引入</h4> <h4 id="优化无限列表性能"><a href="#优化无限列表性能" class="header-anchor">#</a> 优化无限列表性能</h4> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <p>长列表滚动到可视区域动态加载</p></div> <p>如果你的应用存在非常长或者无限滚动的列表，那么需要采用 窗口化 的技术来优化性能，只需要渲染少部分区域的内容，减少重新渲染组件和创建 dom 节点的时间</p> <p>你可以参考以下开源项目 vue-virtual-scroll-list 和 vue-virtual-scroller 来优化这种无限列表的场景的</p> <h4 id="服务端渲染"><a href="#服务端渲染" class="header-anchor">#</a> 服务端渲染</h4> <ul><li>更好的 SEO</li> <li>首屏加载更快</li></ul> <h3 id="webpack-层面优化"><a href="#webpack-层面优化" class="header-anchor">#</a> Webpack 层面优化</h3> <h4 id="webpack-对图片进行压缩"><a href="#webpack-对图片进行压缩" class="header-anchor">#</a> webpack 对图片进行压缩</h4> <p>在 vue 项目中除了可以在 webpack.base.conf.js 中 url-loader 中设置 limit 大小来对图片处理，对小于 limit 的图片转化为 base64 格式，其余的不做操作</p> <p>所以对有些较大的图片资源，在请求资源的时候，加载会很慢，我们可以用 image-webpack-loader 来压缩图片</p> <h4 id="减少-es6-转为-es5-的冗余代码"><a href="#减少-es6-转为-es5-的冗余代码" class="header-anchor">#</a> 减少 ES6 转为 ES5 的冗余代码</h4> <h4 id="提取公共代码"><a href="#提取公共代码" class="header-anchor">#</a> 提取公共代码</h4> <p>如果项目中没有去将每个页面的第三方库和公共模块提取出来，则项目会存在两个问题：</p> <ul><li>1、相同的资源被重复加载，浪费用户的流量和服务器的成本</li> <li>2、每个页面需要加载的资源太大，导致网页首屏加载缓慢，影响用户体验</li></ul> <p>Webpack 内置了专门用于提取多个 Chunk 中的公共部分的插件   CommonsChunkPlugin 我们需要在项目中 CommonsChunkPlugin 进行配置</p> <h4 id="模板预编译"><a href="#模板预编译" class="header-anchor">#</a> 模板预编译</h4> <p>当使用 DOM 内模板或 JavaScript 内的字符串模板时，模板会在运行时被编译为渲染函数。通常情况下这个过程已经足够快了，但对性能敏感的应用还是最好避免这种用法。</p> <p>预编译模板最简单的方式就是使用单文件组件——相关的构建设置会自动把预编译处理好，所以构建好的代码已经包含了编译出来的渲染函数而不是原始的模板字符串。</p> <p>如果你使用 webpack，并且喜欢分离 JavaScript 和模板文件，你可以使用 vue-template-loader，它也可以在构建过程中把模板文件转换成为 JavaScript 渲染函数</p> <h4 id="提取组件的-css"><a href="#提取组件的-css" class="header-anchor">#</a> 提取组件的 css</h4> <p>当使用单文件组件时，组件内的 CSS 会以 style 标签的方式通过 JavaScript 动态注入。<br>
这有一些小小的运行时开销，如果你使用服务端渲染，这会导致一段 “无样式内容闪烁 (fouc) ”。<br>
将所有组件的 CSS 提取到同一个文件可以避免这个问题，也会让 CSS 更好地进行压缩和缓存</p> <h4 id="优化-sourcemap"><a href="#优化-sourcemap" class="header-anchor">#</a> 优化 SourceMap</h4> <p>我们在项目进行打包后，会将开发中的多个文件代码打包到一个文件中，并且经过压缩、去掉多余的空格、babel 编译化后，最终将编译得到的代码会用于线上环境，那么这样处理后的代码和源代码会有很大的差别</p> <p>当有 bug 的时候，我们只能定位到压缩处理后的代码位置，无法定位到开发环境中的代码，对于开发来说不好调式定位问题，因此 sourceMap 出现了，它就是为了解决不好调式代码问题的</p> <h3 id="基础-web-技术优化"><a href="#基础-web-技术优化" class="header-anchor">#</a> 基础 web 技术优化</h3> <h4 id="浏览器缓存"><a href="#浏览器缓存" class="header-anchor">#</a> 浏览器缓存</h4> <p>为了提高用户加载页面的速度，对静态资源进行缓存是非常必要的，根据是否需要重新向服务器发起请求来分类</p> <p>将 HTTP 缓存规则分为两大类（强制缓存，对比缓存）</p> <h4 id="开启-gzip-压缩"><a href="#开启-gzip-压缩" class="header-anchor">#</a> 开启 gzip 压缩</h4> <p>gzip 是 GNUzip 的缩写，最早用于 UNIX 系统的文件压缩</p> <p>HTTP 协议上的 gzip 编码是一种用来改进 web 应用程序性能的技术，web 服务器和客户端（浏览器）必须共同支持 gzip</p> <p>目前主流的浏览器，Chrome，firefox，IE 等都支持该协议。常见的服务器如 Apache，Nginx，IIS 同样支持</p> <p>gzip 压缩效率非常高，通常可以达到 70% 的压缩率，也就是说，如果你的网页有 30K，压缩之后就变成了 9K 左右</p> <h4 id="cdn-的使用"><a href="#cdn-的使用" class="header-anchor">#</a> CDN 的使用</h4> <p>浏览器从服务器上下载 CSS、js 和图片等文件时都要和服务器连接，而大部分服务器的带宽有限，如果超过限制，网页就半天反应不过来</p> <p>而 CDN 可以通过不同的域名来加载文件，从而使下载文件的并发连接数大大增加，且 CDN 具有更好的可用性，更低的网络延迟和丢包率</p> <h2 id="vuex"><a href="#vuex" class="header-anchor">#</a> Vuex</h2> <p>公共状态管理</p> <h3 id="五个核心参数"><a href="#五个核心参数" class="header-anchor">#</a> 五个核心参数</h3> <ul><li>state</li> <li>getters</li> <li>mutations</li> <li>actions</li> <li>modules</li></ul> <h4 id="state"><a href="#state" class="header-anchor">#</a> state</h4> <div class="custom-block tip"><p class="custom-block-title">相当于组件中的 data</p> <p>专门用来存放全局数据</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vue<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	state<span class="token operator">:</span><span class="token punctuation">{</span>
		num<span class="token operator">:</span><span class="token number">0</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>页面的数字：{{$store.state.num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="getters"><a href="#getters" class="header-anchor">#</a> getters</h4> <div class="custom-block tip"><p class="custom-block-title">相当于组件中的 computed</p> <p>只不过 getters 是全局的，computed 是组件内的</p></div> <div class="language-js extra-class"><pre class="language-js"><code>state<span class="token operator">:</span><span class="token punctuation">{</span>
	num<span class="token operator">:</span><span class="token number">0</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
getters<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token keyword">return</span> state<span class="token punctuation">.</span>num
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>
  Home 页面的数字，{{$store.getters.getNum}}
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h4 id="mutations"><a href="#mutations" class="header-anchor">#</a> mutations</h4> <div class="custom-block tip"><p class="custom-block-title">相当于组件中的 methods</p> <p>但它不能使用异步方法，比如定时器之类</p></div> <div class="language-js extra-class"><pre class="language-js"><code>getters<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> state<span class="token punctuation">.</span>num
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
mutations<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token function">increase</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>payload</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    state<span class="token punctuation">.</span>num <span class="token operator">+=</span> payload <span class="token operator">?</span> payload<span class="token operator">:</span><span class="token number">1</span>
    <span class="token comment">// payload 是一个形参，如果组件在 commit 时，有传参数过来，就存在</span>
    <span class="token comment">// 如果没有传过来，就是 undefined</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击加1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
methods<span class="token operator">:</span><span class="token punctuation">{</span>
	<span class="token function">addFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		<span class="token comment">// 调用 store 中 mutations 里 increase 方法</span>
		<span class="token comment">// 如果要传递参数的话，就用 payload</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increase'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>


</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意：</p> <p>更改 Vuex 的 store 中状态的唯一方法是 提交 mutation</p></div> <h4 id="actions"><a href="#actions" class="header-anchor">#</a> actions</h4> <div class="custom-block tip"><p class="custom-block-title">专门用来处理异步</p> <p>实际修改状态值的，依然是 mutations</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">Vuex<span class="token punctuation">.</span>Store</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token comment">// state 相当于组件中的 data</span>
  state<span class="token operator">:</span><span class="token punctuation">{</span>
		num<span class="token operator">:</span><span class="token number">0</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// getters 相当于组件中的 computed</span>
  <span class="token comment">// getters 是全局的，computed 是组件内部的</span>
  getters<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token function">getNum</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
			<span class="token keyword">return</span> state<span class="token punctuation">.</span>num
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// muations 相当于组件中的 methods，但它不能使用异步</span>
  mutations<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token comment">// 让 num 累加</span>
    <span class="token comment">// playload 是一个形参，组件在 commit 时，</span>
    <span class="token comment">// 如果不传参，它就是 undefined</span>
    <span class="token function">increase</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>payload</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		state<span class="token punctuation">.</span>num <span class="token operator">+=</span> payload<span class="token operator">?</span>payload<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        state<span class="token punctuation">.</span>num<span class="token operator">--</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  actions<span class="token operator">:</span><span class="token punctuation">{</span>
		<span class="token comment">// 点击”减1“按钮后，等待1秒再执行</span>
    <span class="token function">decreaseAsync</span><span class="token punctuation">(</span><span class="token parameter">context</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
		context<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'decrease'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>如何调用？</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击加1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
 	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reduceFn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击减1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
	<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
		methods<span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token function">addFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// 调用 store 中 mutations 里 increase 方法</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token string">'increase'</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function">reduceFn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">'decreaseAsync'</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h3 id="辅助函数"><a href="#辅助函数" class="header-anchor">#</a> 辅助函数</h3> <div class="language-js extra-class"><pre class="language-js"><code>computed<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>name
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>虽然这样引入起来方便多了，但是如果变量很多的时候，这样引入代码量就会很大</p> <p><strong>这个时候辅助函数出现了</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'nickname'</span><span class="token punctuation">,</span><span class="token string">'age'</span><span class="token punctuation">,</span><span class="token string">'gender'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
</code></pre></div><p>这一句代码就相当于下面这些</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">nickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>nickname<span class="token punctuation">}</span>
<span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>age<span class="token punctuation">}</span>
<span class="token function">gender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$store<span class="token punctuation">.</span>state<span class="token punctuation">.</span>gender<span class="token punctuation">}</span>
</code></pre></div><p>所以最终变成了</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home 页面的数字为 {{num}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>About 页面的数字为 {{getNum}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapState<span class="token punctuation">,</span>mapGetters <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  computed<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapState</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'num'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">...</span><span class="token function">mapGetters</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'getNum'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>increase(2)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击加1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>decreaseAsync()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击延迟减1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token punctuation">{</span> mapMutations<span class="token punctuation">,</span>mapActions <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vuex'</span>

<span class="token keyword">export</span> <span class="token keyword">default</span><span class="token punctuation">{</span>
  methods<span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token operator">...</span><span class="token function">mapMutations</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'increase'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token operator">...</span><span class="token function">mapActions</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'decreaseAsync'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">注意：</p> <p>mapMutations 和 mapActions 在组件中都是写在 methods 里</p></div> <h3 id="模块化写法"><a href="#模块化写法" class="header-anchor">#</a> 模块化写法</h3> <p>可以细分目录来拆分</p> <p>目录结构如下：</p> <ul><li><strong>store</strong> <ul><li>cart
<ul><li>state.js</li> <li>getters.js</li> <li>mutations.js</li> <li>actions.js</li></ul></li> <li>users
<ul><li>state.js</li> <li>getters.js</li> <li>actions.js</li></ul></li></ul></li></ul> <h3 id="与-localstorage-、cookie-的区别"><a href="#与-localstorage-、cookie-的区别" class="header-anchor">#</a> 与 localStorage 、cookie 的区别</h3> <h4 id="为什么不用-localstorage"><a href="#为什么不用-localstorage" class="header-anchor">#</a> 为什么不用 localStorage</h4> <p>vuex 刷新后就没有了，需要再次从服务器中请求数据 ，存在于虚拟内存当中。</p> <p>而 localStorage 一直存在，如果有这个数据，就不会从服务器请求。<br>
但是这种持久化存储也是存在问题的，它一直都有，怎么保证刷新频次呢？</p> <p><em>设置一个时间，当一定时间后，会从服务器中拉取一次数据</em></p> <blockquote><p>比如 app 的首页数据，不需要频繁从服务器中获取，我们可以用 localStorage</p></blockquote> <h4 id="为什么不用-cookie"><a href="#为什么不用-cookie" class="header-anchor">#</a> 为什么不用 cookie</h4> <p>因为存储的容量太小了，仅仅只有4K</p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/myvuepress/assets/js/app.7911cd3e.js" defer></script><script src="/myvuepress/assets/js/2.a950c495.js" defer></script><script src="/myvuepress/assets/js/11.351c49a2.js" defer></script>
  </body>
</html>
